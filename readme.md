# Вступление

Проект разделен на **2** части

1. **Бекенд**, написанный на **fastapi** - нужен для авторизации и последующего использования до **50.000** токенов без авторизации в сбербанк ID
2. **Фронтенд**, написанный на **pyqt** - основной интерфейс программы

# Класс, его методы и функции бекенда

Единственный класс бекенда - **Database** для работы с базой данных, его методы:

- **\_\_init\_\_** - создание соединения с базой данных
- **create_tables** - создание таблиц
- **login_user** - проверка на существование аккаунта
- **register_user** - создание аккаунта
- **get_token_used** - получение количества использованных токенов аккаунта
- **increase_token_used** - увеличение использованных токенов аккаунта

Функции Бекенда:

- **POST /login** - получение jwt токена аккаунта
- **POST /register** - создание аккаунта и получение его jwt токена
- **GET /gigachat** - получение ответа на вопрос к нейросети, доступно до 50 тысяч токенов
- **validate** - проверка jwt токена на валидность
- **get_answer** - получение ответа нейросети на поставленный вопрос
- **main** - точка входа в программу

# Классы, их методы и функции фронтенда:

Класс **Database** для работы с базой данных, его методы:

- **\_\_init\_\_** - создание соединения с базой данных
- **create_tables** - создание таблиц
- **add_request** - создание записей - логов использования помощника
- **get_last_request** - получение последней записи
- **get_last_num** - получение последнего ответа на математическое выражение
- **close_connection** - закрыть соединение с базой данных
- **reopen_connection** - открыть соединение с базой данных заново

Класс **Helperog** - основное окно программы, его методы:

- **\_\_init\_\_** - создание интерфейса окна и потока для микрофона
- **open_chat** - открыть окно чата с ботом
- **open_settings** - открыть окно настроек
- **set_token** - установить токен с настроек
- **listen_handler** - хендлер нажатия на кнопку микрофона
- **stop_thread** - остановить поток микрофона
- **stop_handler** - остановка программы от команды "выключись"

Класс **Settings** - окно настроек, его методы:

- **\_\_init\_\_** - создание интерфейса окна
- **save_config** - сохранение выбранного микрофона
- **update_microphones** - обновление списка микрофонов

Класс **InputTokenDialog** - диалоговое окно для установки токена, его методы:

- **\_\_init\_\_** - создание интерфейса диалога
- **save_config** - сохранение токена в файл и выход из диалога

Класс **Chat** - окно чата, его методы:

- **\_\_init\_\_** - создание интерфейса окна
- **add_message** - создание и добавление сообщения на экран
- **send_message** - кнопка хендлер нажатия на кнопку отправления сообщения
- **open_main** - функция открытия основного окна

Класс **Message** - описание сообщения, используется в классе **Chat**, методов нет

Класс **LoginWindow**, его методы:

- **\_\_init\_\_** - создание интерфейса окна
- **open_main** - открытие главного окна приложения - **Helperog**
- **open_register** - открытие окна регистрации, если отсутствует аккаунт

Класс **Register**, его методы:

- **\_\_init\_\_** - создание интерфейса окна
- **open_main** - открытие главного окна приложения - **Helperog**
- **open_login** - открытие окна входа в аккаунт, если он уже отсутствует


# Описание запуска

Запуск стоит начать с команд `cd backend`, `python main.py`
Данная команда запускает сервер на локальном адресе 127.0.0.1 и порту 8000
После запуска сервера на fastapi, следует запустить клиентскую часть программы - `cd frontend`, `python main.py`
Для просмотра тестовой, нерабочей части клиентской программы - окон входа и регистрации запустите файл командой `python main.py test`